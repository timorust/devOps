# 1. Handshake Client Hello

**Client hello => [Ver]-[Rand#]-[Sess.ID]- [Ciphers]-[Ext]**

```js
1. Version => highest version of TLS/SSL Client support
2. Random Number => 32 bytes / 256 bits Timestamp encoded in first you bytes
3.Session ID => 8 bytes / 32 bits 00000...All 0`s in initial Client Hello
4. Cipher Suites => List of Cipher suites Client supported
5. Extensions => Optional additional features added to SSL/TLS
```

# 2. Handshake Server Hello

**Server hello => [Ver]-[Rand#]-[Sess.ID]- [Ciphers]-[Ext]**

```js
1. Version => highest version of TLS/SSL Server support
2. Random Number => 32 bytes / 256 bits Timestamp encoded in first you bytes
3.Session ID => 8 bytes / 32 bits Value generated by Server to identify ensuing Session Keys
4. Cipher Suites => Cipher suites selected by Server
5. Extensions => Optional additional features added to SSL/TLS
```

**_Server_** :

```javascript
1. Certificate
2. Public Key
3. Privet Key
4. Version
5. Client Random
6. Server Random
7. Session ID
8. Cipher Suite
```

**_Client_** :

```javascript
1. Version
2. Client Random
3. Server Random
4. Session ID
5. Cipher Suite
```

# 3. Server Handshake Certificate

**Handshake Certificate => [Certificate Chain]**

```js
Server Certificate and full certificate chain
```

**_Client_** :

```javascript
1. Version
2. Client Random
3. Server Random
4. Session ID
5. Cipher Suite
6. Certificate
```

# 4. Handshake Server Hello Done

```js
Indicate server has nothing more to send at this time
```

# 5. Client Key Exchange

**Client Key Exchange => [Pre-Master-Secret]**

```js
Establish Mutual Keying Material (i.e., SEED Value)
Proves Server is true owner of Certificate
```

```php
1. Client generates [Pre-Master-Secret]
 2 bytes - TSL/SSL Version
 46 bytes - Random

2. [Pre-Master-Secret] is encrypted with Server`s Public Key
	Server can only decrypt if it has Server Private Key
```

**_Client_** :

```javascript
1. Version
2. Client Random
3. Server Random
4. Session ID
5. Cipher Suite
6. Certificate
7. Pre-Master-Secret
```

**_Server_** :

```javascript
1. Certificate
2. Public Key
3. Privet Key
4. Version
5. Client Random
6. Server Random
7. Session ID
8. Cipher Suite
9.Pre-Master-Secret
```

# 5. Client Key Exchange [Pre-Master-Secret] - Extension

**Both parties have matching SEED Values**

```javascript
SEED value used to generate Session Keys
```

**Calculation involve a PRF => Pseudo Random Function** length

```javascript
Hashing algorithm than generates digest at any desired
```

```js
// Pre Master Secret used to drive Master Secret
function PSeudoRandom = {
	PreMasterSecret,
	"master secret",
	Client Random,
	Server Random
}
// Master Secret used to generate Session Keys
function PSeudoRandom = {
	MasterSecret,
	"key expansion",
	Client Random,
	Server Random
}
```

**_Client Encryption Key_**

**_Client HMAC Key_**

**_Server Encryption Key_**

**_Server HMAC Key_**

```js
Encryption Key is a cryptographic
Hash-based Message Authentication Code
```

**_[IV] => Client I.V. => _**
**_[IV] => Server I.V. => _**

```javascript
Initialization Vector - IV
```

**_Client_** :

```javascript
1. Version
2. Client Random
3. Server Random
4. Session ID
5. Cipher Suite
6. Certificate
7. Pre-Master-Secret
8. Session Keys
```

**_Server_** :

```javascript
1. Certificate
2. Public Key
3. Privet Key
4. Version
5. Client Random
6. Server Random
7. Session ID
8. Cipher Suite
9.Pre-Master-Secret
10. Session Keys
```

**At this point, both parties have _identical_ Session Keys**

**BUT CLIENT and SERVER don`t know _whether the order_ has the same Keys**

```javascript
Rest of the handshake will prove to both parties than the other party has the correct session keys.
```

# . Client => Change Cipher Spec

**Change Cipher Specification**

```javascript
Indicates Client has everything necessary to speak securely
```

# 6. Client Handshake Finished

```js
Proves to Server that Client has correct Session Keys
```

**Handshake Finished => [Encrypted Verification]**

**_Client calculates Hash of all Handshake Records seen so far_**

5 Record Handshake:

```javascript
function Hash = {
	const HandshakeHash:
		Client Hello
		Server Hello
		Certificate
		Server Hello Done
		Client Key Exchange
  return HandshakeHash
}
```

**_Combined with other values to create Verification Data_**

```js
function PseudoRandomFunc = {
	 const VerificationData:
	    Master Secret,
	    "client finished",
	    HandshakeHash
	 return VerificationData
}
```

**_Verification Data encrypted with CLIENT Session Keys_**

_Server verifies with Server`s copy of Client Session_

_Validates than Client/Server "saw" the same Handshake Record_

```js
const EncryptedVerification = {
	VerificationData,
	CLIENT Session Keys
}
```

# . Server => Change Cipher Spec

**Change Cipher Specification**

# 7. Server Handshake Finished

```js
Proves to Client that Server has correct Session Keys
```

**Handshake Finished => [Encrypted Verification]**

**Server calculates Hash of all Handshake Records seen so far**

6 Record Handshake:

```javascript
function Hash = {
	const HandshakeHash:
		Client Hello
		Server Hello
		Certificate
		Server Hello Done
		Client Key Exchange
		Client Finished
  return HandshakeHash
}
```

**_Combined with other values to create Verification Data_**

```js
function PseudoRandomFunc = {
	 const VerificationData:
	    Master Secret,
	    "server finished",
	    HandshakeHash
	 return VerificationData
}
```

Client verifies with Clients`s copy of Server Session Keys\_

```js
const EncryptedVerification = {
	VerificationData,
	CLIENT Session Keys
}
```

**_APPLICATION DATA WITH SESSION KEYS_**
